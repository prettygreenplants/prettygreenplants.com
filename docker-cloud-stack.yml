app:
  autoredeploy: true
  environment:
    - FLOW_CONTEXT=Production
  image: 'prettygreenplants/app:latest'
  links:
    - db
    - redis
  volumes:
    - '/var/www/prettygreenplants/neos:/var/www'
    - '/var/www/prettygreenplants/scripts/cleanup.sh:/cleanup.sh:ro'
db:
  command: mysqld --character-set-server=utf8 --collation-server=utf8_unicode_ci
  environment:
    - MYSQL_DATABASE=prettygreenplants
    - MYSQL_PASSWORD=prettygreenplants
    - MYSQL_ROOT_PASSWORD=root
    - MYSQL_USER=prettygreenplants
  image: 'mariadb:10.1'
  volumes:
    - '/var/lib/mysql:/var/lib/mysql'
redis:
  image: 'redis:alpine'
web:
  autoredeploy: true
  environment:
    - NGINX_HOST=prettygreenplants.com
    - USE_SELF_SIGNED_CERTIFICATE=False
  image: 'prettygreenplants/nginx:latest'
  links:
    - app
  ports:
    - '80:80'
    - '443:443'
  volumes:
    - '/var/www/prettygreenplants/neos:/var/www'
    - '/etc/letsencrypt:/etc/letsencrypt'
